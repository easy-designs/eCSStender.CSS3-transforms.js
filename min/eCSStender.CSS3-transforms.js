/*------------------------------------------------------------------------------
Function:       eCSStender.CSS3-transforms.js
Author:         Aaron Gustafson (aaron at easy-designs dot net)
Creation Date:  2010-05-23
Version:        0.1
Homepage:       http://github.com/easy-designs/eCSStender.CSS3-transforms.js
License:        MIT License 
Note:           If you change or improve on this script, please let us know by
                emailing the author (above) with a link to your demo page.
------------------------------------------------------------------------------*/
(function(){if(eCSStender===undefined){return}var c=eCSStender,f=new a(c),d,b;function a(w){var y,x="property",s="-moz-",q="-webkit-",h="-khtml-",m="-o-",p=" ",o=": ",t="; ",u="(",g=")",j="transform",l="rotate",v="deg",k="matrix(0.707107, 0.707107, -0.707107, 0.707107, 0, 0)",i="filter: progid:DXImageTransform.Microsoft.Matrix",n=i+"(sizingMethod='auto expand')";w.register({fragment:j,filter:{value:/rotate\(-?\d+deg\)/},test:function(){var e=j+o+k;return(!w.isSupported(x,e)&&(w.isSupported(x,s+e)||w.isSupported(x,q+e)||w.isSupported(x,h+e)||w.isSupported(x,m+e)||w.isSupported(x,n)))},fingerprint:"net.easy-designs."+j+u+l+g},false,r);function r(D,G,J){var F,A="",I=A,B=j+o+k,E=(w.isSupported(x,s+B)||w.isSupported(x,q+B)||w.isSupported(x,h+B)||w.isSupported(x,m+B)),z=w.isSupported(x,n),e,C,H,K;if(z&&w.methods.MSSetOrigin===F){if(window.jQuery===F){d.loadScript("http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js",function(){b=window.jQuery;r(D,G,J)});return}eCSStender.addMethod("MSSetOrigin",function(M,L,N){d.addToMatrix(M,{Dx:L,Dy:N})});eCSStender.addMethod("MSRotate",function(M,ac){var ae=b(M),ab="top",X="left",S="px",Z="auto",aa="height",T="position",P="relative",L="background-color",R=ae.height(),U=ae.width(),ad=ac*(Math.PI*2/360),Q=Math.cos(ad),W=Math.sin(ad),N,V,Y,O;M.contentEditable=true;d.addToMatrix(M,{M11:Q,M12:-W,M21:W,M22:Q,SizingMethod:"auto expand"});N=R-ae.height();V=ae.width()-U;if(ae.css(T)=="static"){ae.css({position:P,top:N+S,left:V+S})}else{Y=ae.css(ab);O=ae.css(X);ae.css({top:(N+parseInt(Y!=Z?Y:0,10))+S,left:(V+parseInt(O!=Z?O:0,10))+S})}if(ae.css(T)==P){ae.css("margin-bottom",ae.css(ab))}if(ae.css(L)=="transparent"){ae.css(L,ae.parent().css(L))}})}if(z){K=b(D)}C=parseInt(G[j].replace(/rotate\((-?\d+)deg\)/,"$1"),10);for(e in G){if(E){if(e==j){H=j+o+l+u+C+v+g+t}else{H=e+o+G[e]+t}I+=s+H+q+H+h+H+m+H}else{if(z){switch(e){case j:K.each(function(){eCSStender.methods.MSRotate(this,C)});break;case j+"-origin":K.each(function(){var O="top",M="bottom",S="left",P="right",Q=b(this),X=Q.height(),N=Q.width(),W=G[e].split(" "),V,U;if(W[0]==O||parseInt(W[0],10)==0||W[1]==O){V=0}else{if(W[0]==M||W[1]==M){V=N}else{if(W[0].match(/\d+?%/)){V=N*(100/parseInt(W[0],10))}else{if(W[0].match(/\d+?px/)){V=parseInt(W[0],10)}else{V=N/2}}}}var U;if(W[0]==S||W[1]==S||parseInt(W[1],10)==0){U=0}else{if(W[0]==P||W[1]==P){U=X}else{if(W[1].match(/\d+?%/)){U=X*(100/parseInt(W[1],10))}else{if(W[1].match(/\d+?px/)){U=parseInt(W[1],10)}else{U=X/2}}}}eCSStender.methods.MSSetOrigin(this,V,U)});break}}}}if(I!=A){w.embedCSS(D+" { "+I+"} ",J)}}}d={addToMatrix:function(g,j){var h=false,m=g.style.filter.replace(/.*?Microsoft\.Matrix\(([^\)]+)\)/,"$1").split(","),l,e,k="progid:DXImageTransform.Microsoft.Matrix(";if(g.style.filter!=""){e=m.length;while(e--){l=m[e].split("=");if(j[l[0]]!==undefined&&j[m[e][0]]!=h){k+=this.getParamString(l[0],j[l[0]]);j[l[0]]=h}else{k+=this.getParamString(l[0],l[1])}}}for(l in j){if(!c.isInheritedProperty(j,l)){k+=this.getParamString(l,j[l])}}k=k.substring(0,k.length-1)+")";g.style.filter=k;g.style.msfilter=k},getParamString:function(h,g){var e=typeof(g),i=h+"=";if(e.toLowerCase()=="number"){i+=g}else{i+="'"+g+"'"}return i+","},loadScript:function(g,h){var e=document.createElement("script");e.type="text/javascript";e.onreadystatechange=function(){if(e.readyState=="loaded"||e.readyState=="complete"){e.onreadystatechange=null;if(h instanceof Function){h()}}};e.src=g;document.getElementsByTagName("head")[0].appendChild(e)}}})();